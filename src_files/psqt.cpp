//
// Created by Luecx on 06.12.2020.
//

#include "psqt.h"

EvalScore piece_square_tables[64][64][12][64]{};

// indexed by piece
EvalScore piece_values[6] = {
    M(   97,  115),
    M(  370,  410),
    M(  390,  364),
    M(  466,  712),
    M( 1182, 1329),
};


// indexed by piece, relation to king
EvalScore4i piece_our_king_square_table[5][15*15]{
    {
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L( -45,  30, -45,  30), L( -45,  24, -45,  24), L( -42,  27, -42,  27), L( -54,  27, -54,  27), L( -15,  -3, -15,  -3),
        L( -12, -24, -12, -24), L( -78,   6, -78,   6), L( -54, -36, -54, -36), L(  -9, -21,  -9, -21), L(  -3, -21,  -3, -21),
        L( -18,   0, -18,   0), L( -21,   9, -21,   9), L( -12,  27, -12,  27), L( -21,  42, -21,  42), L( -69,  81, -69,  81),
        L( -27,  18, -27,  18), L( -12,  24, -12,  24), L(  -6,  12,  -6,  12), L(   0,   3,   0,   3), L(  -9,  -6,  -9,  -6),
        L(   0, -21,   0, -21), L(   3,  -9,   3,  -9), L( -15,   0, -15,   0), L(   6, -30,   6, -30), L(  -6, -21,  -6, -21),
        L(   0, -15,   0, -15), L(  -3,   9,  -3,   9), L(  -6,  18,  -6,  18), L(  -3,  24,  -3,  24), L( -12,  21, -12,  21),
        L(   0,  -9,   0,  -9), L(  -3,  12,  -3,  12), L(  -6,   9,  -6,   9), L(   0,   0,   0,   0), L(   0,  -9,   0,  -9),
        L(   3, -12,   3, -12), L(   3, -15,   3, -15), L(   0,  -6,   0,  -6), L(   3, -21,   3, -21), L(  -6, -12,  -6, -12),
        L(   0, -12,   0, -12), L(  -3,   3,  -3,   3), L(   0,   6,   0,   6), L(   0,   6,   0,   6), L(  -6,   3,  -6,   3),
        L(  -3,   0,  -3,   0), L(   0,   0,   0,   0), L(  -3,   3,  -3,   3), L(  -3,   0,  -3,   0), L(  -3,   0,  -3,   0),
        L(   0,  -3,   0,  -3), L(   3,   0,   3,   0), L(   9,  -3,   9,  -3), L(   3,  -9,   3,  -9), L(  -3,  -6,  -3,  -6),
        L(  -3,   0,  -3,   0), L(  -3,   0,  -3,   0), L(  -3,   0,  -3,   0), L(   0,  -3,   0,  -3), L(   3,  -9,   3,  -9),
        L(   0,  -9,   0,  -9), L(   0,   0,   0,   0), L(  -3,   0,  -3,   0), L(   0,   3,   0,   3), L(  -6,   3,  -6,   3),
        L(  -6,   6,  -6,   6), L(   6,   6,   6,   6), L(  15,   6,  15,   6), L(  -3,   9,  -3,   9), L(  -3,   6,  -3,   6),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(  -3,   0,  -3,   0), L(   0,   0,   0,   0), L(   6, -12,   6, -12),
        L(  -3,  -3,  -3,  -3), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   3,   0,   3,   0), L(   6,   0,   6,   0),
        L(   0,   3,   0,   3), L(  -6,  -9,  -6,  -9), L(   3,  -3,   3,  -3), L(  -9,   0,  -9,   0), L(   0,   3,   0,   3),
        L(   3,   3,   3,   3), L(  -3,   0,  -3,   0), L(  -3,   0,  -3,   0), L(   0,  -3,   0,  -3), L(   3,  -9,   3,  -9),
        L(   3,  -9,   3,  -9), L(  -3,   0,  -3,   0), L(   0,   0,   0,   0), L(  -3,   3,  -3,   3), L(   0,   3,   0,   3),
        L(   0,   6,   0,   6), L(  -3,  -3,  -3,  -3), L(   0,   0,   0,   0), L(   3,   0,   3,   0), L(  -6,   9,  -6,   9),
        L(  -3,   3,  -3,   3), L(  -9,   6,  -9,   6), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   6, -12,   6, -12),
        L(  -9,  -3,  -9,  -3), L(   9,  -3,   9,  -3), L(  -3,   3,  -3,   3), L(   3,   0,   3,   0), L( -15,   9, -15,   9),
        L( -18,   9, -18,   9), L( -36,   3, -36,   3), L( -30,  27, -30,  27), L( -36,   0, -36,   0), L(  -9,   9,  -9,   9),
        L( -12,   9, -12,   9), L(   0,   3,   0,   3), L(   9,   0,   9,   0), L(  15,  -6,  15,  -6), L(  -3,  -9,  -3,  -9),
        L(   6,   0,   6,   0), L(   9,  -9,   9,  -9), L( -15,   6, -15,   6), L( -15,   3, -15,   3), L( -33,  12, -33,  12),
        L( -39,   6, -39,   6), L( -36,   6, -36,   6), L(   0,   0,   0,   0), L( -36,   6, -36,   6), L( -15,   3, -15,   3),
        L( -39,  15, -39,  15), L(  -9,   6,  -9,   6), L(  -9,   6,  -9,   6), L(   6,  -3,   6,  -3), L(  -6,  -6,  -6,  -6),
        L(  -6,  -3,  -6,  -3), L( -30,   6, -30,   6), L(  -6,   3,  -6,   3), L( -30,   9, -30,   9), L( -42,  12, -42,  12),
        L( -42,   9, -42,   9), L( -24,   3, -24,   3), L( -12,   6, -12,   6), L( -27,   3, -27,   3), L( -18,   3, -18,   3),
        L( -42,  15, -42,  15), L(  -9,   9,  -9,   9), L(  -9,   3,  -9,   3), L(  -3,   0,  -3,   0), L(   3,  -9,   3,  -9),
        L( -78,   0, -78,   0), L(  -3,  -3,  -3,  -3), L(  15,   6,  15,   6), L(  -9,   3,  -9,   3), L( -39,  15, -39,  15),
        L( -69,  12, -69,  12), L( -42,  12, -42,  12), L( -30,  12, -30,  12), L( -42,  12, -42,  12), L(  -9,   0,  -9,   0),
        L(  -9,  15,  -9,  15), L( -18,   3, -18,   3), L( -27,   3, -27,   3), L(  30, -12,  30, -12), L( -51,   0, -51,   0),
        L(   3, -15,   3, -15), L(  27,   0,  27,   0), L( -15,   9, -15,   9), L( -27,  12, -27,  12), L( -57,   6, -57,   6),
        L( -72,  21, -72,  21), L( -15,   9, -15,   9), L( -21,  15, -21,  15), L( -78,  15, -78,  15), L( -30,  15, -30,  15),
        L(  30,   3,  30,   3), L( -21,   0, -21,   0), L( -27,   0, -27,   0), L( -12,   3, -12,   3), L(  21, -33,  21, -33),
        L(-102, -24,-102, -24), L( -84,   3, -84,   3), L(   3,  18,   3,  18), L(  54,  12,  54,  12), L( -27,  30, -27,  30),
        L(  12,  21,  12,  21), L(  15,   3,  15,   3), L(  15,  -9,  15,  -9), L( -42, -12, -42, -12), L( -36, -12, -36, -12),
        L(   6,   0,   6,   0), L(  33, -33,  33, -33), L(  90, -24,  90, -24), L(  15, -27,  15, -27), L(-144, -24,-144, -24),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
    },
    {
    
    },
    {
    
    },
    {
    
    },
    {
    
    },
};
EvalScore4i piece_opp_king_square_table[5][15*15]{
    {
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,  36,   0,  36), L( -90,  99, -90,  99), L(  36,  69,  36,  69), L(  39,  66,  39,  66), L(  78, 108,  78, 108),
        L(  81, 108,  81, 108), L( 120, 126, 120, 126), L( 153, 204, 153, 204), L( 153, 156, 153, 156), L( 114, 123, 114, 123),
        L(  84,  93,  84,  93), L(-183, 126,-183, 126), L(-153,  75,-153,  75), L( -42,  54, -42,  54), L(  -6,  57,  -6,  57),
        L(  33,  78,  33,  78), L(-201,  57,-201,  57), L( -93,  42, -93,  42), L(-129,  57,-129,  57), L( -30,  69, -30,  69),
        L(   9, 111,   9, 111), L(  60, 114,  60, 114), L( -33, 111, -33, 111), L(  84,  96,  84,  96), L(  12,  93,  12,  93),
        L(  57,  60,  57,  60), L(-123,  45,-123,  45), L(-252,  57,-252,  57), L(-174,  75,-174,  75), L(-120,  51,-120,  51),
        L( -90,  45, -90,  45), L(-135,  39,-135,  39), L(-111,  24,-111,  24), L( -69,   9, -69,   9), L( -18,  30, -18,  30),
        L(  24,  57,  24,  57), L(   9,  69,   9,  69), L(  21,  66,  21,  66), L(   6,  63,   6,  63), L(  30,  54,  30,  54),
        L( -27,  36, -27,  36), L( -57,  -3, -57,  -3), L(-105,  12,-105,  12), L(-111,  24,-111,  24), L(-150,  21,-150,  21),
        L( -90,  15, -90,  15), L( -66,  12, -66,  12), L( -39,   3, -39,   3), L( -27,  -3, -27,  -3), L(   6,   9,   6,   9),
        L( -18,  30, -18,  30), L( -24,  42, -24,  42), L( -33,  30, -33,  30), L(  27,  33,  27,  33), L( -30,  30, -30,  30),
        L( -24,   9, -24,   9), L( -30, -12, -30, -12), L( -57,   3, -57,   3), L(-102,  12,-102,  12), L(-114,  27,-114,  27),
        L( -63,  21, -63,  21), L( -18,   0, -18,   0), L( -24,  -3, -24,  -3), L( -24,  -9, -24,  -9), L(  -6,   6,  -6,   6),
        L( -27,   6, -27,   6), L( -57,  15, -57,  15), L( -75,   9, -75,   9), L( -48,  12, -48,  12), L( -24,   3, -24,   3),
        L( -27,  12, -27,  12), L( -51,  -6, -51,  -6), L( -24,  -3, -24,  -3), L( -45,   9, -45,   9), L( -30,  15, -30,  15),
        L( -15,   6, -15,   6), L( -18,   0, -18,   0), L( -12,  -3, -12,  -3), L(  -6,  -9,  -6,  -9), L(  12,   0,  12,   0),
        L( -12,   0, -12,   0), L( -48,  27, -48,  27), L( -81,  27, -81,  27), L( -84,  33, -84,  33), L( -36,   6, -36,   6),
        L( -15,   3, -15,   3), L(  -9,  -6,  -9,  -6), L( -18,   0, -18,   0), L( -15,   6, -15,   6), L( -15,   6, -15,   6),
        L(  -3,   6,  -3,   6), L( -18,   0, -18,   0), L(  -3,  -3,  -3,  -3), L(   0,  -9,   0,  -9), L(  -3,   0,  -3,   0),
        L(  -3,   0,  -3,   0), L(   3,  -9,   3,  -9), L(   0,   0,   0,   0), L( -15, -12, -15, -12), L( -33,   6, -33,   6),
        L( -12,   0, -12,   0), L(  -9,  -3,  -9,  -3), L(   0,  -3,   0,  -3), L(  -9,   3,  -9,   3), L( -12,   9, -12,   9),
        L(  -6,   6,  -6,   6), L(  -3,   0,  -3,   0), L(  -3,   0,  -3,   0), L(  -3,  -3,  -3,  -3), L(   3,   0,   3,   0),
        L(   9,   0,   9,   0), L( -60,  15, -60,  15), L( -66,   9, -66,   9), L( -75,  15, -75,  15), L(   0,   0,   0,   0),
        L(  -3,   3,  -3,   3), L(  -3,   0,  -3,   0), L(  -3,   3,  -3,   3), L(  -6,   6,  -6,   6), L( -12,  12, -12,  12),
        L(   6,  -3,   6,  -3), L(  -9,   6,  -9,   6), L(   0,  -3,   0,  -3), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   6,   3,   6,   3), L(  12,   0,  12,   0), L(  21,  -6,  21,  -6), L(  15,   3,  15,   3), L(  -3,   6,  -3,   6),
        L(  -3,   0,  -3,   0), L(  -6,   3,  -6,   3), L(  -6,   3,  -6,   3), L(  -3,   6,  -3,   6), L(  -3,   3,  -3,   3),
        L(  -6,   3,  -6,   3), L(   0,   0,   0,   0), L(  -3,   3,  -3,   3), L(   3,   0,   3,   0), L(   3,   0,   3,   0),
        L(   6,   0,   6,   0), L(   0,   3,   0,   3), L(  -9,  -3,  -9,  -3), L(   3,   3,   3,   3), L(   0,   3,   0,   3),
        L(   0,   0,   0,   0), L(   3,   0,   3,   0), L(   3,   0,   3,   0), L(   3,   3,   3,   3), L(  -6,   3,  -6,   3),
        L(  -3,  -3,  -3,  -3), L(  -3,   3,  -3,   3), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   3,   0,   3,   0),
        L(   3,  -3,   3,  -3), L(  -3,   0,  -3,   0), L(  -6,  -6,  -6,  -6), L(  -3,   0,  -3,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   6,   0,   6,   0), L(   3,   3,   3,   3), L(  -3,   3,  -3,   3),
        L(   0,  -3,   0,  -3), L(   0,   3,   0,   3), L(   0,   0,   0,   0), L(   3,   0,   3,   0), L(   3,   0,   3,   0),
        L(   3,   0,   3,   0), L(  -6,   0,  -6,   0), L(  -9,  -3,  -9,  -3), L(  -3,   3,  -3,   3), L(   0,   3,   0,   3),
        L(   0,   0,   0,   0), L(   0,   3,   0,   3), L(   3,   0,   3,   0), L(   3,   3,   3,   3), L(   0,  -3,   0,  -3),
        L(   0,   3,   0,   3), L(   3,  -3,   3,  -3), L(   3,  -3,   3,  -3), L(  -3,   3,  -3,   3), L(   3,   0,   3,   0),
        L(   0,   3,   0,   3), L(  -3,  -6,  -3,  -6), L(  -6,  -3,  -6,  -3), L(  -3,   6,  -3,   6), L(   0,   0,   0,   0),
        L(   3,  -3,   3,  -3), L(   0,   3,   0,   3), L(   3,   0,   3,   0), L(   3,   3,   3,   3), L(   0,  -3,   0,  -3),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
        L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0), L(   0,   0,   0,   0),
    },
    {
    
    },
    {
    
    },
    {
    
    },
    {
    
    },
};



// indexed by piece, sameSideCastle, square
EvalScore piece_square_table[6][2][64]{
    {
        {   // pawn, same side castle
            M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0),
            M(   -9,   -4), M(   18,    8), M(   11,   31), M(  -10,   35), M(  -14,   23), M(  -17,   22), M(  -20,   25), M(  -19,   35),
            M(    4,    2), M(   12,    1), M(   11,   19), M(    4,   18), M(   -4,   10), M(  -13,   17), M(  -20,   19), M(  -19,   29),
            M(    2,    9), M(    7,   15), M(   15,   13), M(   19,    8), M(    7,    6), M(    2,   10), M(  -17,   32), M(  -15,   35),
            M(   14,   25), M(   16,   30), M(   44,   16), M(   35,   11), M(   22,    5), M(    1,   31), M(   -7,   43), M(  -12,   56),
            M(   20,   45), M(   77,   37), M(  113,   20), M(   56,   17), M(   33,   28), M(   28,   58), M(   15,   82), M(  -12,   93),
            M(   28,  134), M(   23,  129), M(  195,   74), M(  211,   78), M(  194,  112), M(  190,  143), M(  179,  165), M(  202,  160),
            M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0),
        },
        {   // pawn, opposite side castle
            M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0),
            M(    7,   23), M(   32,   16), M(   14,   26), M(  -12,   37), M(  -23,   36), M(  -29,   38), M(  -47,   43), M(  -42,   44),
            M(   18,   19), M(   27,   14), M(   11,   24), M(    1,   22), M(   -9,   25), M(  -21,   29), M(  -49,   34), M(  -42,   36),
            M(   16,   40), M(   13,   40), M(   11,   29), M(   11,   22), M(    9,   19), M(    1,   26), M(  -29,   35), M(  -34,   34),
            M(   12,   82), M(   15,   71), M(   17,   53), M(   20,   35), M(   34,   18), M(   34,   18), M(  -11,   38), M(  -20,   33),
            M(    1,  158), M(   38,  146), M(   37,  119), M(   28,   72), M(   61,   22), M(   91,    7), M(   65,   17), M(    1,   37),
            M(  197,  239), M(  209,  239), M(  174,  219), M(  183,  166), M(  198,  100), M(  204,   51), M(   51,   94), M(   53,   96),
            M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0), M(    0,    0),
        }
    },
    {
        {
            M( -38, -62), M(  -5, -46), M(   2, -29), M(   5, -26), M(   3, -23), M( -10, -42), M(  -6, -72), M( -53, -65),
            M(  -3, -28), M(  -9, -12), M(   5, -24), M(   4,  -6), M(   6, -13), M( -16, -23), M( -28, -17), M( -36, -36),
            M(  -5, -29), M(   7,  -4), M(   9,  -1), M(  13,  12), M(   5,  16), M(  -9, -10), M( -13, -22), M( -26, -56),
            M(   4,   1), M(  34,  16), M(   8,  39), M(  14,  38), M(   0,  34), M(  -4,  23), M( -15,   4), M( -17, -27),
            M(   6,   7), M(   0,  24), M(  31,  39), M(   2,  45), M(  14,  48), M(   6,  23), M( -10,  -1), M( -17, -11),
            M( -14,   2), M(  15,  23), M(  72,  37), M(  51,  23), M(  21,  28), M(  21,  22), M( -12,   2), M( -50, -13),
            M(   7, -13), M( -48,  20), M(  62,  -7), M(  34,  17), M(  38,  24), M(  15,  -6), M( -36,  -6), M( -27, -30),
            M(-168, -57), M(-106,  17), M(-141,  56), M( -24,  13), M( -60,  18), M(-167,  43), M(-163,  14), M(-272, -28),
        },
        {
            M( -44, -69), M( -33, -13), M(   1, -22), M(   7,  -4), M(   3,   0), M( -13, -15), M( -13, -34), M( -61, -23),
            M( -12, -29), M( -17,  -4), M(   1, -13), M(   9,   0), M(  13,   3), M(  -6,   1), M( -39,  15), M( -42, -15),
            M( -15, -27), M(  -1,   0), M(  12,   6), M(  12,  27), M(  19,  29), M(   0,  15), M(  -1,  -4), M( -28, -20),
            M(   6,  -2), M(  23,  12), M(  25,  32), M(  22,  44), M(  35,  42), M(  19,  38), M(  30,  18), M(   6,  -3),
            M(   1,   4), M(  15,  12), M(  38,  29), M(  46,  49), M(  25,  55), M(  41,  48), M(  17,  17), M(  15,   0),
            M( -31,  -7), M(  24,   7), M(  47,  30), M(  49,  36), M(  68,  32), M(  85,  35), M(  42,   2), M(   8, -14),
            M( -13, -22), M(  -4,  -3), M(  53, -10), M(  80,  17), M(  52,  13), M(  52,   0), M( -14,   0), M(  13, -28),
            M(-206, -63), M(-153,  22), M(-128,  33), M( -49,  25), M( -12,   1), M(-100,  26), M( -38,   2), M(-202, -29),
        }
    },
    {
        {
            M( -16, -20), M( -35,  -3), M( -19,   0), M( -34,   4), M( -26,  -2), M( -23,  -4), M( -15,   1), M(  -4, -18),
            M( -15, -26), M(   9, -18), M(  -9, -10), M( -15,   5), M( -22,   4), M( -11,  -6), M(  -8, -16), M(  -9, -18),
            M(   7,   0), M(  -6,   5), M(  -2,   8), M( -11,  17), M(  -8,  17), M( -13,  11), M(  -4,   2), M( -21,   2),
            M( -15,   7), M( -15,  17), M( -26,  26), M(   6,  19), M(  -1,  22), M( -10,  20), M( -21,   8), M( -34,  -1),
            M( -29,  21), M( -12,  30), M(  -1,  24), M(   1,  31), M(  22,  22), M( -16,  20), M(  -9,  13), M( -48,  19),
            M( -18,  26), M(  20,  29), M(  28,  32), M(  24,  20), M(  -3,  20), M(   7,  16), M( -27,  29), M( -35,  15),
            M( -55,  22), M( -22,  25), M(   6,  18), M( -39,  28), M( -49,  28), M( -38,  27), M( -39,  28), M( -88,  34),
            M( -75,  28), M( -33,  17), M(-153,  38), M(-115,  36), M(-138,  46), M(-151,  43), M(-117,  52), M( -91,  44),
        },
        {
            M(   7,   9), M( -24,  15), M(  -6,  17), M( -24,  23), M( -21,  23), M( -27,  17), M( -24,  20), M( -21,  18),
            M(  12, -12), M(  41,   2), M(  13,  10), M(   5,  16), M( -15,  21), M( -15,  19), M( -20,   8), M( -13,   7),
            M(  12,  11), M(  28,  19), M(  33,  23), M(   6,  26), M(   4,  33), M( -13,  30), M( -10,  21), M( -21,  23),
            M( -11,  24), M(  10,  30), M(  10,  32), M(  37,  30), M(  12,  36), M(   0,  35), M(  -6,  23), M(  -7,  18),
            M( -16,  40), M(   5,  37), M(  17,  38), M(  29,  38), M(  48,  38), M(  16,  30), M(  20,  35), M(  -6,  22),
            M( -23,  37), M(  13,  41), M(  16,  39), M(  25,  39), M(  54,  31), M(  67,  37), M(  46,  25), M(   3,  25),
            M( -62,  48), M( -42,  53), M( -14,  47), M( -46,  48), M( -20,  45), M(  44,  23), M(   4,  30), M( -54,  24),
            M( -71,  67), M( -91,  50), M( -93,  48), M( -97,  58), M(-124,  51), M(-101,  49), M(  11,  31), M( -31,  48),
        }
    },
    {
        {
            M( -16, -10), M(  16,  -1), M(  20,   6), M(  21,  -1), M(  21,   0), M(  11,  11), M(   3,   5), M(  -4,   4),
            M( -81,  10), M(  13, -12), M(  18, -12), M(   5,   0), M(   5,   2), M(  -7,  10), M( -10,   2), M( -45,  10),
            M( -20,  -1), M(  22,   9), M(   7,  10), M(  -1,  11), M(  -1,  14), M( -18,  22), M(  -8,  21), M( -25,  13),
            M(  -9,  22), M(  21,  28), M(   3,  33), M(  -2,  32), M(  -4,  36), M( -14,  44), M( -15,  44), M( -18,  30),
            M(  29,  34), M(  49,  28), M(  51,  33), M(  36,  36), M(  47,  35), M(  19,  46), M(   7,  40), M(  -5,  44),
            M(  44,  37), M( 114,  19), M( 104,  30), M(  83,  23), M(  57,  34), M(  30,  46), M(  42,  36), M(  -7,  53),
            M(  41,  44), M(  55,  46), M( 117,  27), M(  36,  62), M(  39,  60), M(  20,  62), M(  -7,  66), M(   2,  58),
            M(  84,  44), M(  78,  47), M(  97,  42), M(  25,  55), M(  12,  62), M(   3,  68), M(  24,  61), M(  26,  56),
        },
        {
            M( -27,  20), M(   5,  15), M(  11,  18), M(  19,  11), M(  23,   6), M(  31,  10), M(  31,   6), M(   1,  11),
            M( -78,  26), M( -20,   9), M(  -3,  13), M(  -2,  17), M(   5,  13), M(  14,  10), M(  21,   0), M( -31,  15),
            M( -31,  16), M(   9,  20), M( -14,  27), M(  -7,  25), M(  -9,  23), M(   0,  23), M(  11,  22), M(  -4,  13),
            M(  -9,  37), M(  22,  36), M(   0,  47), M(  -2,  47), M(   0,  37), M(   0,  43), M(   7,  39), M(  -3,  30),
            M(  21,  48), M(  34,  40), M(  47,  39), M(  53,  45), M(  45,  40), M(  44,  44), M(  45,  32), M(  44,  30),
            M(  35,  46), M(  89,  24), M(  69,  43), M(  80,  36), M(  91,  32), M(  98,  32), M( 115,  18), M(  53,  33),
            M(  43,  50), M(  50,  51), M(  59,  51), M(  49,  67), M(  57,  57), M( 125,  26), M(  54,  42), M(  50,  38),
            M( 108,  32), M(  85,  45), M(  68,  53), M(  50,  56), M(  60,  49), M( 139,  24), M(  93,  38), M(  53,  52),
        }
    },
    {
        {
            M( -26, -25), M( -17, -42), M(  -7, -26), M(   8, -16), M(   7,   3), M(   1, -15), M(  -4, -10), M(  -9,   3),
            M( -23, -23), M(   9, -69), M(  19, -68), M(   7, -10), M(   6,  -4), M(  10, -35), M(   1, -12), M(  -9,  -2),
            M(  13, -11), M(  20,   0), M(   6,  14), M(   1,  -8), M(  -2,  -8), M(  -4,   9), M(   2,   3), M( -11,   5),
            M(  20,  28), M(  16,  27), M(   7,  25), M( -10,  35), M( -15,  31), M( -11,   8), M(  -9,  25), M( -17,  24),
            M(  14,  28), M(  21,  56), M(   8,  56), M( -15,  55), M( -26,  56), M( -30,  27), M( -31,  53), M( -34,  49),
            M( -18,  43), M(  42,  42), M(  30,  32), M(  14,  37), M( -15,  26), M( -35,  41), M( -37,  43), M( -49,  69),
            M(  12,  72), M( -51, 124), M(  96,  -6), M( -64,  90), M( -67,  81), M( -40,  57), M( -91, 109), M( -47,  82),
            M(  48,   7), M(  13,  52), M(  47,  10), M( -19,  31), M( -15,  31), M( -29,  59), M( -34,  71), M( -55,  88),
        },
        {
            M( -36,   3), M( -14, -24), M(  -1, -30), M(  -1,  17), M(  -2,  22), M(  -6,   9), M( -11,  45), M( -10,  30),
            M( -44,   4), M( -10,  -3), M(  20, -36), M(  15,  18), M(   6,  18), M(  15,  -5), M(  17,   6), M(   7,  24),
            M( -25,  36), M(   6,  25), M(   4,  44), M(   2,  29), M(  -2,  34), M(   8,  34), M(  16,  26), M(  18,  25),
            M( -16,  59), M(  -2,  63), M( -15,  71), M(  -5,  85), M(  -9,  73), M(   6,  58), M(  16,  46), M(  26,  26),
            M( -10,  69), M( -29, 105), M( -25,  74), M( -16,  96), M(   4,  86), M(  20,  66), M(  39,  56), M(  24,  35),
            M( -24,  96), M(  -3,  60), M(  -1,  68), M(  -2,  70), M(  33,  68), M(  32,  75), M(  65,  22), M(  14,  33),
            M( -15,  81), M( -61, 134), M( -16,  86), M( -57, 122), M( -67, 136), M(  86,  25), M( -15,  76), M(  13,  42),
            M(  -3,  79), M(   4,  82), M(  -5,  74), M( -16,  78), M( -13,  69), M( 126, -20), M(  -1,  54), M(  22,  22),
        }
    },
    {
        {
            M( -34, -96), M( 127, -50), M(  79, -21), M( 118, -16), M(  85, -26), M(  48, -13), M(  39, -10), M(-165, -64),
            M(  14, -32), M( 121,  10), M( 212, -16), M( 201, -20), M( 153, -13), M( 171,  -9), M(  60,  24), M(  18, -30),
            M(  32,   1), M( 141,  17), M( 195,   6), M( 176,   0), M( 178,  -4), M( 196,   6), M( 124,  18), M(  21,  -3),
            M( -14,  13), M(  99,   7), M( 134,  15), M( 107,  19), M( 119,  15), M( 130,  14), M(  81,   5), M( -57,  11),
            M( -22, -14), M(  84,  -3), M(  91,  16), M(  60,  27), M(  75,  28), M(  65,  21), M(  80,   1), M( -30, -13),
            M( -14, -13), M(  12,   4), M(  29,  15), M(  18,  29), M(  32,  28), M(  16,  23), M(  10,   8), M( -17,  -8),
            M(  40, -24), M(  15,  -2), M(   8,  10), M( -28,  19), M(  -5,  18), M( -14,  20), M(  20,  -3), M(  37, -28),
            M(  42, -74), M(  47, -39), M(  25, -20), M(  10, -32), M(  13, -40), M(  -7, -12), M(  56, -35), M(  65, -91),
        },
        {
            M( -34, -96), M( 127, -50), M(  79, -21), M( 118, -16), M(  85, -26), M(  48, -13), M(  39, -10), M(-165, -64),
            M(  14, -32), M( 121,  10), M( 212, -16), M( 201, -20), M( 153, -13), M( 171,  -9), M(  60,  24), M(  18, -30),
            M(  32,   1), M( 141,  17), M( 195,   6), M( 176,   0), M( 178,  -4), M( 196,   6), M( 124,  18), M(  21,  -3),
            M( -14,  13), M(  99,   7), M( 134,  15), M( 107,  19), M( 119,  15), M( 130,  14), M(  81,   5), M( -57,  11),
            M( -22, -14), M(  84,  -3), M(  91,  16), M(  60,  27), M(  75,  28), M(  65,  21), M(  80,   1), M( -30, -13),
            M( -14, -13), M(  12,   4), M(  29,  15), M(  18,  29), M(  32,  28), M(  16,  23), M(  10,   8), M( -17,  -8),
            M(  40, -24), M(  15,  -2), M(   8,  10), M( -28,  19), M(  -5,  18), M( -14,  20), M(  20,  -3), M(  37, -28),
            M(  42, -74), M(  47, -39), M(  25, -20), M(  10, -32), M(  13, -40), M(  -7, -12), M(  56, -35), M(  65, -91),
        }
    },
};

// indexed by wking, bking, piece, square
EvalScore piece_kk_square_tables[64][64][12][64];

void psqt_init() {
    for(Square wKingSq = 0; wKingSq < 64; wKingSq++){
        for(Square bKingSq = 0; bKingSq < 64; bKingSq++){
            
            bool   wKSide            = (fileIndex(wKingSq) > 3 ? 0 : 1);
            bool   bKSide            = (fileIndex(bKingSq) > 3 ? 0 : 1);
            bool   sameSideCastle    = wKSide == bKSide;
            
            // pawn, knight, bishop, rook, queen
            for(Piece p = 0; p < 5; p++){
                for(Square sq = 0; sq < 64; sq++){
                    
                    piece_kk_square_tables[wKingSq][bKingSq][p]  [sq]
                        = + piece_square_table              [p][!sameSideCastle][pst_index_white(sq, wKSide)]
                          + piece_values                    [p]
                          + piece_our_king_square_table     [p]     [pst_index_relative_white(sq, wKingSq)]
                          + piece_opp_king_square_table     [p]     [pst_index_relative_white(sq, bKingSq)];

                    piece_kk_square_tables[wKingSq][bKingSq][p+6][sq]
                        = - piece_square_table              [p][!sameSideCastle][pst_index_black(sq, bKSide)]
                          - piece_values                    [p]
                          - piece_our_king_square_table     [p]     [pst_index_relative_black(sq, bKingSq)]
                          - piece_opp_king_square_table     [p]     [pst_index_relative_black(sq, wKingSq)];
                }
            }
            
            // kings
            for(Square sq = 0; sq < 64; sq++){
                piece_kk_square_tables[wKingSq][bKingSq][WHITE_KING][sq]
                    = + piece_square_table[KING][0][pst_index_white_s(sq)];
                piece_kk_square_tables[wKingSq][bKingSq][BLACK_KING][sq]
                    = - piece_square_table[KING][0][pst_index_black_s(sq)];
            }
            
        }
    }
}